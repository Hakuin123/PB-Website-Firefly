import{A as e,_ as s,a3 as t,$ as n,C as o,Q as f,z as i,L as c,af as r,S as a}from"./render.BevYug5V.js";class h{anchor;#e=new Map;#s=new Map;#t=new Map;#n=new Set;#o=!0;constructor(e,s=!0){this.anchor=e,this.#o=s}#f=()=>{var f=e;if(this.#e.has(f)){var i=this.#e.get(f),c=this.#s.get(i);if(c)s(c),this.#n.delete(i);else{var a=this.#t.get(i);a&&(this.#s.set(i,a.effect),this.#t.delete(i),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),c=a.effect)}for(const[e,s]of this.#e){if(this.#e.delete(e),e===f)break;const n=this.#t.get(s);n&&(t(n.effect),this.#t.delete(s))}for(const[e,s]of this.#s){if(e===i||this.#n.has(e))continue;const f=()=>{if(Array.from(this.#e.values()).includes(e)){var n=document.createDocumentFragment();r(s,n),n.append(o()),this.#t.set(e,{effect:s,fragment:n})}else t(s);this.#n.delete(e),this.#s.delete(e)};this.#o||!c?(this.#n.add(e),n(s,f,!1)):f()}}};#i=e=>{this.#e.delete(e);const s=Array.from(this.#e.values());for(const[n,o]of this.#t)s.includes(n)||(t(o.effect),this.#t.delete(n))};ensure(s,t){var n=e,r=a();if(t&&!this.#s.has(s)&&!this.#t.has(s))if(r){var h=document.createDocumentFragment(),d=o();h.append(d),this.#t.set(s,{effect:f(()=>t(d)),fragment:h})}else this.#s.set(s,f(()=>t(this.anchor)));if(this.#e.set(n,s),r){for(const[e,t]of this.#s)e===s?n.unskip_effect(t):n.skip_effect(t);for(const[e,t]of this.#t)e===s?n.unskip_effect(t.effect):n.skip_effect(t.effect);n.oncommit(this.#f),n.ondiscard(this.#i)}else i&&(this.anchor=c),this.#f()}}export{h as B};
